<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>GCC的简单使用教程上 | Qiang's Life</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">GCC的简单使用教程上</h1><a id="logo" href="/.">Qiang's Life</a><p class="description">夜阑卧听风吹雨</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">GCC的简单使用教程上</h1><div class="post-meta">Aug 4, 2009<span> | </span><span class="category"><a href="/categories/Linux/">Linux</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p>GCC(GNU Compiler Collection)是LINUX平台下最强大的编译器，它不仅能编译<br>C，C++，object c,它还可以通过不同的前端模块来支持各种语言,如 Java、Fortran、<br>Pascal、Modula-3 和 Ada 等。<br>编译过程<br>在使用 GCC 编译程序时,编译过程可以被细分为四个阶段:<br>◆ 预处理(Pre-Processing)<br>◆ 编译(Compiling)<br>◆ 汇编(Assembling)<br>◆ 链接(Linking)<br>下面我们来看一段简单的代码”:<br>?<br>View Code<br>C<br>1<br>2<br>3<br>4<br>5<br>6</p>
<p>#include<br>int<br>main<br>(<br>void<br>)<br>{<br>printf<br>(<br>“Hello world !<br>\n<br>“<br>)<br>;<br>return<br>0<br>;<br>}<br>现在编译执行：<br>?<br>View Code<br>BASH<br>1<br>2<br>3<br>$<br>gcc<br>hello.c<br>-o<br>hello<br>$ .<br>/<br>hello<br>Hello world<br>!<br>为了弄清楚编译的过程，我们现在把编译分成几个单独的步骤：<br>第一步是进行预编译,使用-E 参数可以让 GCC 在预处理结束后停止编译过程:<br>?<br>View Code<br>BASH<br>1<br>$<br>gcc<br>-E<br>hello.c<br>-o<br>hello.i<br>此时若查看 hello.cpp 文件中的内容,会发现 stdio.h 的内容确实都插到文件里去了,而其它应当被预处理的宏定义也都做了相应的处理。下一步是将 hello.i 编译为目标代码,这可以通过使用-c 参数来完成:<br>?<br>View Code<br>BASH<br>1<br>$<br>gcc<br>-c<br>hello.i<br>-o<br>hello.o<br>GCC 默认将.i 文件看成是预处理后的 C 语言源代码,因此上述命令将自动跳过预处<br>理步骤而开始执行编译过程,也可以使用-x 参数让 GCC 从指定的步骤开始编译。最<br>后一步是将生成的目标文件链接成可执行文件:<br>?<br>View Code<br>BASH<br>1<br>$<br>gcc<br>hello.o<br>-o<br>hello<br>在采用模块化的设计思想进行软件开发时,通常整个程序是由多个源文件组成的,相<br>应地也就形成了多个编译单元,使用 GCC 能够很好地管理这些编译单元。假设有一<br>个由 foo1.c 和 foo2.c 两个源文件组成的程序,为了对它们进行编译,并最终生成可执<br>行程序 foo,可以使用下面这条命令:<br>?<br>View Code<br>BASH<br>1<br>$<br>gcc<br>foo1.c foo2.c<br>-o<br>foo<br>如果同时处理的文件不止一个,GCC 仍然会按照预处理、编译和链接的过程依次进<br>行。如果深究起来,上面这条命令大致相当于依次执行如下三条命令:<br>?<br>View Code<br>BASH<br>1<br>2<br>3<br>$<br>gcc<br>-c<br>foo1.c<br>-o<br>foo1.o<br>$<br>gcc<br>-c<br>foo2.c<br>-o<br>foo2.o<br>$<br>gcc<br>foo1.o foo2.o<br>-o<br>foo<br>警告提示功能<br>GCC 包含完整的出错检查和警告提示功能,它们可以帮助 Linux 程序员写出更加专<br>业和优美的代码。常用的警告选项有：<br>-pedantic ：使用了扩展语法的地方将产生相应的警告信息。<br>-Wall ：使用它能够使 GCC 产生尽可能多的警告信息。<br>-Werror：它要求 GCC 将所有的警告当成错误进行处理。<br>库依赖<br>GCC 采用搜索目录的办法来查找所需要的文件,-I 选项可以向 GCC 的头文件搜索路<br>径中添加新的目录。例如,如果在/home/xiaowp/include/目录下有编译时所需要的头<br>文件,为了让 GCC 能够顺利地找到它们,就可以使用-I 选项:<br>?<br>View Code<br>BASH<br>1<br>$<br>gcc<br>foo.c<br>-I<br>/<br>home<br>/<br>xiaowp<br>/<br>include<br>-o<br>foo<br>同样,如果使用了不在标准位置的库文件,那么可以通过-L 选项向 GCC 的库文件搜索路径中添加新的目录。例如,如果在/home/xiaowp/lib/目录下有链接时所需要的库文<br>件 libfoo.so,为了让 GCC 能够顺利地找到它,可以使用下面的命令:<br>?<br>View Code<br>BASH<br>1<br>$<br>gcc<br>foo.c<br>-L<br>/<br>home<br>/<br>xiaowp<br>/<br>lib<br>-lfoo<br>-o<br>foo<br>值得好好解释一下的是-l 选项,它指示 GCC 去连接库文件 libfoo.so。Linux 下的库文<br>件在命名时有一个约定,那就是应该以 lib 三个字母开头,由于所有的库文件都遵循了<br>同样的规范,因此在用-l 选项指定链接的库文件名时可以省去 lib 三个字母,也就是说<br>GCC 在对-lfoo 进行处理时,会自动去链接名为libfoo.so 的文件。<br>Linux 下的库文件分为两大类分别是动态链接库(通常以.so 结尾)和静态链接库(通常<br>以.a 结尾),两者的差别仅在程序执行时所需的代码是在运行时动态加载的,还是在编<br>译时静态加载的。默认情况下,GCC 在链接时优先使用动态链接库,只有当动态链接<br>库不存在时才考虑使用静态链接库,如果需要的话可以在编译时加上-static 选项,强制<br>使用静态链接库。例如,如果在/home/xiaowp/lib/目录下有链接时所需要的库文件<br>libfoo.so 和 libfoo.a,为了让 GCC 在链接时只用到静态链接库,可以使用下面的命令:<br>?<br>View Code<br>BASH<br>1<br>$<br>gcc<br>foo.c<br>-L<br>/<br>home<br>/<br>xiaowp<br>/<br>lib<br>-static<br>-lfoo<br>-o<br>foo<br>后记：这篇文章是在我看了《开源》杂志第四期里的一篇文章改写的。作者是肖文鹏。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://hackqiang.org/2009/08/04/gcc-e7-9a-84-e7-ae-80-e5-8d-95-e4-bd-bf-e7-94-a8-e6-95-99-e7-a8-8b-e4-b8-8a/" data-id="cj8vijrsy00bviqmgcvxg6qk9" class="article-share-link">分享到</a><div class="tags"><a href="/tags/GCC/">GCC</a></div><div class="post-nav"><a href="/2009/08/06/linux-socket-e5-ad-a6-e4-b9-a0-e7-ac-94-e8-ae-b019-udp-e5-b9-bf-e6-92-ad-e6-9c-8d-e5-8a-a1-e5-99-a8-e7-ab-af/" class="pre">Linux Socket 学习笔记19-UDP广播服务器端</a><a href="/2009/08/03/linux-socket-e5-ad-a6-e4-b9-a0-e7-ac-94-e8-ae-b018-e5-ae-9a-e4-b9-89-e7-bc-93-e5-86-b2-e6-93-8d-e4-bd-9c/" class="next">Linux Socket 学习笔记18-定义缓冲操作</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://hackqiang.org"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C-C/">C/C++</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/DIY/">DIY</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/embeded/">embeded</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/kernel-drivers/">kernel/drivers</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/乱七八糟/">乱七八糟</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/动漫/">动漫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/心情琐事/">心情琐事</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/手机/">手机</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/未分类/">未分类</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/域名/" style="font-size: 15px;">域名</a> <a href="/tags/总结/" style="font-size: 15px;">总结</a> <a href="/tags/命令技巧/" style="font-size: 15px;">命令技巧</a> <a href="/tags/kernel/" style="font-size: 15px;">kernel</a> <a href="/tags/3d打印机/" style="font-size: 15px;">3d打印机</a> <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/ip/" style="font-size: 15px;">ip</a> <a href="/tags/arm/" style="font-size: 15px;">arm</a> <a href="/tags/objdump/" style="font-size: 15px;">objdump</a> <a href="/tags/Ubuntu/" style="font-size: 15px;">Ubuntu</a> <a href="/tags/C-C/" style="font-size: 15px;">C/C++</a> <a href="/tags/TCP-IP/" style="font-size: 15px;">TCP/IP</a> <a href="/tags/环境变量/" style="font-size: 15px;">环境变量</a> <a href="/tags/chrome/" style="font-size: 15px;">chrome</a> <a href="/tags/CLANNAD/" style="font-size: 15px;">CLANNAD</a> <a href="/tags/动漫/" style="font-size: 15px;">动漫</a> <a href="/tags/gentoo/" style="font-size: 15px;">gentoo</a> <a href="/tags/alsa/" style="font-size: 15px;">alsa</a> <a href="/tags/dsplink/" style="font-size: 15px;">dsplink</a> <a href="/tags/oss/" style="font-size: 15px;">oss</a> <a href="/tags/patch/" style="font-size: 15px;">patch</a> <a href="/tags/atreus/" style="font-size: 15px;">atreus</a> <a href="/tags/keyboard/" style="font-size: 15px;">keyboard</a> <a href="/tags/dsp/" style="font-size: 15px;">dsp</a> <a href="/tags/寓意/" style="font-size: 15px;">寓意</a> <a href="/tags/bug/" style="font-size: 15px;">bug</a> <a href="/tags/碎碎念/" style="font-size: 15px;">碎碎念</a> <a href="/tags/Mysql/" style="font-size: 15px;">Mysql</a> <a href="/tags/GAE/" style="font-size: 15px;">GAE</a> <a href="/tags/Gtalk/" style="font-size: 15px;">Gtalk</a> <a href="/tags/XMPP/" style="font-size: 15px;">XMPP</a> <a href="/tags/gedit/" style="font-size: 15px;">gedit</a> <a href="/tags/u-boot/" style="font-size: 15px;">u-boot</a> <a href="/tags/云/" style="font-size: 15px;">云</a> <a href="/tags/面试/" style="font-size: 15px;">面试</a> <a href="/tags/fork/" style="font-size: 15px;">fork</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/GDB/" style="font-size: 15px;">GDB</a> <a href="/tags/论文/" style="font-size: 15px;">论文</a> <a href="/tags/SIGPIPE/" style="font-size: 15px;">SIGPIPE</a> <a href="/tags/bootloader/" style="font-size: 15px;">bootloader</a> <a href="/tags/Nexus-s/" style="font-size: 15px;">Nexus s</a> <a href="/tags/刘翔/" style="font-size: 15px;">刘翔</a> <a href="/tags/手机/" style="font-size: 15px;">手机</a> <a href="/tags/socket/" style="font-size: 15px;">socket</a> <a href="/tags/valgrind/" style="font-size: 15px;">valgrind</a> <a href="/tags/内存泄漏/" style="font-size: 15px;">内存泄漏</a> <a href="/tags/win7/" style="font-size: 15px;">win7</a> <a href="/tags/无线网卡/" style="font-size: 15px;">无线网卡</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/blackberry/" style="font-size: 15px;">blackberry</a> <a href="/tags/Archive-org/" style="font-size: 15px;">Archive.org</a> <a href="/tags/wordpress/" style="font-size: 15px;">wordpress</a> <a href="/tags/博客/" style="font-size: 15px;">博客</a> <a href="/tags/C/" style="font-size: 15px;">C</a> <a href="/tags/vim/" style="font-size: 15px;">vim</a> <a href="/tags/歌曲/" style="font-size: 15px;">歌曲</a> <a href="/tags/日食/" style="font-size: 15px;">日食</a> <a href="/tags/代码片段/" style="font-size: 15px;">代码片段</a> <a href="/tags/高达/" style="font-size: 15px;">高达</a> <a href="/tags/感悟/" style="font-size: 15px;">感悟</a> <a href="/tags/mtrace/" style="font-size: 15px;">mtrace</a> <a href="/tags/IDE/" style="font-size: 15px;">IDE</a> <a href="/tags/PowerPC/" style="font-size: 15px;">PowerPC</a> <a href="/tags/字节序/" style="font-size: 15px;">字节序</a> <a href="/tags/移植/" style="font-size: 15px;">移植</a> <a href="/tags/终端颜色/" style="font-size: 15px;">终端颜色</a> <a href="/tags/旅游/" style="font-size: 15px;">旅游</a> <a href="/tags/西安/" style="font-size: 15px;">西安</a> <a href="/tags/kgdb/" style="font-size: 15px;">kgdb</a> <a href="/tags/github/" style="font-size: 15px;">github</a> <a href="/tags/empathy/" style="font-size: 15px;">empathy</a> <a href="/tags/core/" style="font-size: 15px;">core</a> <a href="/tags/淘宝/" style="font-size: 15px;">淘宝</a> <a href="/tags/Blog/" style="font-size: 15px;">Blog</a> <a href="/tags/8310/" style="font-size: 15px;">8310</a> <a href="/tags/doxygen/" style="font-size: 15px;">doxygen</a> <a href="/tags/镜像/" style="font-size: 15px;">镜像</a> <a href="/tags/麦兜/" style="font-size: 15px;">麦兜</a> <a href="/tags/fate-stay-night/" style="font-size: 15px;">fate stay night</a> <a href="/tags/GCC/" style="font-size: 15px;">GCC</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/gtihub/" style="font-size: 15px;">gtihub</a> <a href="/tags/jay/" style="font-size: 15px;">jay</a> <a href="/tags/logo/" style="font-size: 15px;">logo</a> <a href="/tags/内核模块/" style="font-size: 15px;">内核模块</a> <a href="/tags/Rahman/" style="font-size: 15px;">Rahman</a> <a href="/tags/lcd4linux/" style="font-size: 15px;">lcd4linux</a> <a href="/tags/LFS/" style="font-size: 15px;">LFS</a> <a href="/tags/I-O/" style="font-size: 15px;">I/O</a> <a href="/tags/原子操作/" style="font-size: 15px;">原子操作</a> <a href="/tags/errno/" style="font-size: 15px;">errno</a> <a href="/tags/多线程/" style="font-size: 15px;">多线程</a> <a href="/tags/tcpdump/" style="font-size: 15px;">tcpdump</a> <a href="/tags/UDP/" style="font-size: 15px;">UDP</a> <a href="/tags/缓冲/" style="font-size: 15px;">缓冲</a> <a href="/tags/广播/" style="font-size: 15px;">广播</a> <a href="/tags/带外数据/" style="font-size: 15px;">带外数据</a> <a href="/tags/紧急指针/" style="font-size: 15px;">紧急指针</a> <a href="/tags/地址结构/" style="font-size: 15px;">地址结构</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/10/17/hello-Hexo/">Hello Hexo</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/24/e6-9b-b2-e9-9d-a2ergodox-dactyl/">曲面ergodox--dactyl</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/30/e9-83-a8-e5-88-86-e5-9b-9b-e6-9c-88-e7-95-aa-e6-80-bb-e7-bb-93/">部分四月番总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/30/e6-9c-88-e8-89-b2-e7-9c-9f-e7-be-8e/">月色真美</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/21/e9-98-bf-e9-87-8c-e5-9f-9f-e5-90-8d-e8-87-aa-e5-8a-a8-e6-9b-b4-e6-96-b0a-e8-ae-b0-e5-bd-95/">阿里域名自动更新A记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/28/3d-e6-89-93-e5-8d-b0-e6-9c-ba-e4-bc-98-e5-8c-96/">3d打印机优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/25/e4-bd-a0-e7-8e-b0-e5-9c-a8-e6-89-80-e6-8b-85-e5-bf-83-e7-9a-84-e4-b8-80-e5-88-87-ef-bc-8c-e4-b8-8d-e8-bf-87-e6-98-af-e6-9c-aa-e6-9d-a5-e5-bf-86-e8-b5-b7-e5-be-80-e4-ba-8b-e7-9a-84-e5-b0-8f-e6-8f-92/">你现在所担心的一切，不过是未来忆起往事的小插曲罢了。</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/19/trackpoint/">trackpoint</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/18/diy-e4-bc-98-e8-81-94-e7-89-88-e6-9c-ac-e7-9a-84atreus/">DIY 优联版本的atreus</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/14/git-tips/">git tips</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">Qiang's Life.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>